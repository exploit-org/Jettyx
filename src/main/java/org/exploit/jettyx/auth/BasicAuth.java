package org.exploit.jettyx.auth;

import org.eclipse.jetty.client.api.Request;
import org.eclipse.jetty.http.HttpHeader;

import java.util.Base64;

public record BasicAuth(String userName, String password) implements Authorization {
    @Override
    public void apply(Request request) {
        request.headers(mutable -> mutable.add(HttpHeader.AUTHORIZATION, basicValue(userName, password)));
    }

    private static String basicValue(String userName, String password) {
        var format = userName + ":" + password;
        var encodedValue = Base64.getEncoder().encodeToString(format.getBytes());

        return "Basic " + encodedValue;
    }
}